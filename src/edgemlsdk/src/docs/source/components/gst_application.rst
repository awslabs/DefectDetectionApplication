.. |br| raw:: html

   <br />

==============
GstApplication
==============

The GstApplication is a self-contained application designed to launch and manage the lifecycle of one or more GStreamer pipelines based on configurations set by the user.
This provides users the ability to quickly create applications based on GStreamer with no code while allowing them to inject custom functionality through a plugin model.

Events
------

There are 3 types of events that are generated by the GstApplication:

-   **Data**
    Events containing larger payloads that are likely bound for long term storage

-   **Metric**
    Happen at a regular cadence contain measurement data about some facet of the application (e.g. Element latency)

-   **Monitor**
    Happen at the rate of incident and typically used to convey information about the health of the application or a component.

Generated Events
~~~~~~~~~~~~~~~~

During the execution of the GstApplication several events are generated.  This section will enumerate all events generated by the GstApplication, it will not include any possible
events generated by custom GStreamer or Application plugins.  

-   :ref:`Heartbeat <heartbeat-event>`
-   :ref:`Pipeline Error <pipeline-error-event>`
-   :ref:`Pipeline State Change <pipeline-state-change-event>`

.. _heartbeat-event:

**Heartbeat Event**

-   Description: Event reported at regular intervals containing information about the overall health of the application
-   Topic: gst_application_heartbeat
-   Type: Monitor
-   Configuration: 

    -   heartbeat_interval

        Interval, in milliseconds, at which to send the heartbeat.  If property is not specified then it will default to an interval of 10 seconds.
        See :ref:`Sample <config-sample>` for example usage.

-   Payload:

.. code-block::

    {
        "duration": float (Time, in seconds, the application has been running)
    }

.. _pipeline-error-event:

**Pipeline Error Event**

-   Description: Event reported when a pipeline has encountered an error, warning, or end of stream
-   Topic: gst_application_pipeline_error
-   Type: Monitor
-   Payload:

.. code-block::

    {
        "pipeline_id": string (Id of the pipeline specified in the pipeline defitions property),
        "error":
        {
            "code": integer (Error code reported by GStreamer, 0 on EOS),
            "debug_info": string (Debug info reported by GStreamer),
            "domain_string": string (The domain of the error),
            "domain": integer (The domain of the error, as integer, CORE=0, LIBRARY=1, RESOURCE=2, STREAM=3, NOT_DEFINED=4),
            "factory": string (The factory of the element that encountered the error),
            "message": string (error message),
            "name": string (name of the element that encountered the error),
            "type": string (Type of error: 'error', 'warning', 'eos')
        }
    }

For more information on error codes reported from GStreamer see their official documentation https://gstreamer.freedesktop.org/documentation/gstreamer/gsterror.html?gi-language=c

.. _pipeline-state-change-event:

**Pipeline State Change Event**

-   Description: Event reported when a pipeline has changed state
-   Topic: gst_application_pipeline_state
-   Type: Monitor
-   Payload:

.. code-block::

    {
        "pipeline_id": string (Id of the pipeline specified in the pipeline defitions property),
        "old_state": integer (State the pipeline is transitioning from),
        "new_state": integer (State the pipeline has transitioned to)
    }

For more information on GStreamer states see their official documentation https://gstreamer.freedesktop.org/documentation/gstreamer/gstelement.html?gi-language=c#GstState

Configuration
-------------

TODO

.. _config-sample:

Sample
~~~~~~

Sample configuration file for the GstApplication

.. literalinclude:: ../../samples/GstApplication/sample_config.json
    :language: json
    :linenos: